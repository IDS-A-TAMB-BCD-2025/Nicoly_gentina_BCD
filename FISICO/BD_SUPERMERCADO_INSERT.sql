USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO (
    SUP_CNPJ,
    SUP_RAZAO_SOCIAL,
    SUP_TELEFONE,
    SUP_EMAIL,
    SUP_ENDERECO_LOGRADOURO,
    SUP_ENDERECO_NUMERO,
    SUP_ENDERECO_CIDADE,
    SUP_ENDERECO_ESTADO
)
VALUES (
    "123456780000102",
    "Supermercado Grick",
    "19999999999",
    "gricktambau@email.com",
    "Grick Street",
    "10000",
    "Tambacity",
    "SP"
);

INSERT INTO SUPERMERCADO VALUES (
    "123456780000105",
    "Supermercado Pierim",
    "19999999992",
    "pierimtambau@email.com",
    "Pierim Street",
    "10001",
    "Tambacity",
    "SP"
);

INSERT INTO SUPERMERCADO VALUES (
    "123456780000103",
    "Supermercado JaL",
    "19999999997",
    "jaltambau@email.com",
    "Jal Street",
    "10002",
    "Tambacity",
    "SP"
);

INSERT INTO SUPERMERCADO VALUES (
    "123456780000104",
    "Supermercado Pontes",
    "19999999996",
    "pontestambau@email.com",
    "Pontes Street",
    "10003",
    "Tambacity",
    "SP"
);

INSERT INTO SUPERMERCADO VALUES (
    "123456780000106",
    "Supermercado São Francisco",
    "19999999995",
    "saofranciscotambau@email.com",
    "São Francisco Street",
    "10004",
    "Tambacity",
    "SP"
);

SELECT * FROM SUPERMERCADO;     

INSERT INTO PRODUTO ( 	PRO_CODIGO_BARRAS,
						PRO_NOME,
                        PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUES				(	"9239130130",
						"Arroz 5kg",
						 5.0,
                         500,
                         26.90,
                         '2025-12-25');
                         
INSERT INTO PRODUTO ( 	PRO_CODIGO_BARRAS,
						PRO_NOME,
                        PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUES				(	"481980413",
						"Fejãp 5kg",
						 5.0,
                         500,
                         15.90,
                         '2025-12-30');
                         
INSERT INTO PRODUTO ( 	PRO_CODIGO_BARRAS,
						PRO_NOME,
                        PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUES				(	"218991938499",
						"Sabão em pó 2kg",
						 2.0,
                         1000,
                         20.00,
                         '2026-12-25');
                         
INSERT INTO PRODUTO ( 	PRO_CODIGO_BARRAS,
						PRO_NOME,
                        PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUES				(	"814889012908398",
						"Suco de Uva",
						 1.0,
                         2000,
                         10.90,
                         '2025-12-31');

INSERT INTO PRODUTO ( 	PRO_CODIGO_BARRAS,
						PRO_NOME,
                        PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUES				(	"9239130130",
						"Ração 15kg",
						 15.0,
                         200,
                         100.00,
                         '2026-12-26');
                                    
INSERT INTO CONSUMIDOR (
    CON_CPF,
    CON_NOME,
    CON_TELEFONE,
    CON_EMAIL
)
VALUES
("58119104870", "Nicoly", "19995592905", "nocolisgg@gmail.com"),
("47283910566", "Lucas", "19987654321", "lucas@email.com"),
("39284756122", "Ana", "19991234567", "ana@email.com"),
("50928374681", "Bruno", "19999887766", "bruno@email.com"),
("67890543219", "Mariana", "19993456789", "mariana@email.com");

SELECT * FROM CONSUMIDOR;

INSERT INTO FUNCIONARIO (
    FUN_CPF,
    FUN_NOME,
    FUN_DATA_NASCIMENTO,
    FUN_TELEFONE,
    FUN_EMAIL,
    FUN_CARTEIRA_TRABALHO,
    FUN_BANCO_AGENCIA,
    FUN_BANCO_CONTA,
    FUN_DATA_ADMISSAO,
    FUN_JORNADA_TRABALHO,
    FK_SUP_CNPJ
)
VALUES
("49329034820", "José Vanderlei", "1985-03-01", "11987654321", "ze_vanderlei@gmail.com", "carteira_ze_vanderlei.pdf", "1234", "56789", "2020-01-15", "44 horas", "123456780000102"),
("58392017465", "Maria Fernanda", "1990-07-12", "11991234567", "maria.fernanda@email.com", "carteira_maria.pdf", "2345", "67890", "2021-03-10", "40 horas", "123456780000105"),
("67281930457", "Carlos Henrique", "1988-11-23", "11993456789", "carlos.henrique@email.com", "carteira_carlos.pdf", "3456", "78901", "2019-08-05", "44 horas", "123456780000105"),
("72839410562", "Ana Paula", "1995-02-17", "11997654321", "ana.paula@email.com", "carteira_ana.pdf", "4567", "89012", "2022-05-20", "36 horas", "123456780000102"),
("83920174658", "Rafael Gomes", "1992-09-09", "11998765432", "rafael.gomes@email.com", "carteira_rafael.pdf", "5678", "90123", "2023-01-30", "44 horas", "123456780000102");

SELECT * FROM FUNCIONARIO;

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES
("123456780000102", 1),
("123456780000103", 2),
("123456780000104", 3),
("123456780000105", 4),
("123456780000106", 5);

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES
("58119104870", 1),
("47283910566", 2),
("39284756122", 3),
("50928374681", 4),
("67890543219", 5);

SELECT * FROM SUPERMERCADO;

/*
CONSULTAR O AUMENTO DE R$2,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$ 5,00
*/
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL",
       TRUNCATE((PRO_PRECO + 2 ),2) AS "PRECO COM AJUSTE DE R$2,00"
FROM   PRODUTO
WHERE  PRO_PRECO >= 5;

/* 
CONSUNTAR A REDUÇÃO DE R$ 1,00 NO PREÇO DOS PRODUTOS
COM PREÇO ATUAL ABAIXO DE R$5,00
*/

SELECT 	PRO_NOME AS "NOME",
		PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
        PRO_PRECO AS "PRECO ATUAL",
        TRUNCATE((PRO_PRECO -1),2) AS "PREÇO COM REDUÇÃO DE R$1,00"
FROM	PRODUTO	
WHERE	PRO_PRECO <=20;

/*
CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS
*/
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL",
       TRUNCATE((PRO_PRECO - (PRO_PRECO * 0.1)),2) AS "PREÇO COM DESCONTO DE 10%"
FROM   PRODUTO;

/*
AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVINDO PELA METADE
*/
SELECT 	PRO_ID,
		PRO_NOME,
		PRO_CODIGO_BARRAS,
        PRO_QUANTIDADE
FROM 	PRODUTO;

UPDATE	PRODUTO
SET		PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE	PRO_ID = 1;

/* CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO DE 2025 E DEZEMBRO DE 2025*/
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM   PRODUTO
WHERE  PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/* CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE R$10 OU MENOR QUE R$4*/
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO"
FROM   PRODUTO
WHERE  PRO_PRECO >= 10 OR PRO_PRECO <=4;

/*CONSULTAR OS DDS E TELEFONES DOS CONSUMIDORES SEPARADAMENTE*/
SELECT CON_NOME 						AS "NOME DO CONSUMIDOR",
	   CON_CPF  						AS "CPF DO CONSUMIDOR",
       SUBSTRING(CON_TELEFONE, 1, 2)	AS "DDD DO TELEFONE",
       SUBSTRING(CON_TELEFONE, 3, 9)   AS "NÚMERO DO TELEFONE"
FROM   CONSUMIDOR;

/*GERAR UMA FRASE CONCATENANDO : RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL*/
SELECT CONCAT("Razão Social: ",
			   CONCAT(SUP_RAZAO_SOCIAL,
					 CONCAT(" | CNPJ: ",
							CONCAT(SUP_CNPJ,
									CONCAT (" | Telefone: ",
											CONCAT(SUP_TELEFONE,
													CONCAT(" | Email: ", SUP_EMAIL))))))) AS FRASE 
FROM   SUPERMERCADO;

/*GERAR UMA CONSULTA QUE VERIFICA O STATUS DO ESTOQUE DOS PRODUTOS.
REGRAS:
1) QUANTIDADE <=25 : ESTOQUE BAIXO
2) QUANTIDADE > 25 E QAUNTIDADE <=100: ESTOQUE MÉDIO
3) QUANTIDADE > 100>: ESTOQUE ALTO*/

SELECT PRO_NOME 			AS "NOME DO PRODUTO",
	   PRO_CODIGO_BARRAS  	AS "CÓDIGO DE BARRAS",
       PRO_QUANTIDADE		AS "QUANTIDADE",
       CASE
		   WHEN PRO_QUANTIDADE <= 25 THEN "ESTOQUE BAIXO"
           WHEN PRO_QUANTIDADE >25   AND PRO_QUANTIDADE < 100 THEN "ESTOQUE MÉDIO"
           WHEN PRO_QUANTIDADE >100 THEN "ESTOQUE ALTO"
		END AS "NÍVEL DE ESTOQUE"
FROM    PRODUTO;

/*GERAR UMA CONSULTA QUE VERIFICA O PESO DOS PRODUTOS.
REGRAS:
1) PESO <=5 : PESO BAIXO
2) PESO > 5 E QUANTIDADE <=50: PESO MÉDIO
3) PESO >= 50>: PESO ALTO*/

SELECT PRO_NOME 			AS "NOME DO PRODUTO",
	   PRO_CODIGO_BARRAS  	AS "CÓDIGO DE BARRAS",
       PRO_QUANTIDADE       AS "QUANTIDADE",
       PRO_DATA_VALIDADE    AS "DATA DE VALIDADE",
       PRO_PESO      		AS "PESO",
       CASE
		   WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
           WHEN PRO_PESO >5   AND PRO_PESO <= 50 THEN "PESO MÉDIO"
           WHEN PRO_PESO >=50 THEN "PESO ALTO"
		END AS "PESO DO PRODUTO"
FROM    PRODUTO;

/*CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM   CONSUMIDOR;

/*CONTAR QUANTOS SUPERMERCAODS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM   SUPERMERCADO;

/*CONTAR QUANTOS FUNCIONÁRIOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM   FUNCIONARIO;

/*CONTAR QUANTOS PRODUTOS TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM   PRODUTO;

/*SOMAR O PREÇO TOTAL DE TODOS OS PRODUTOS CADASTRADOS*/
SELECT SUM(PRO_PRECO)
FROM   PRODUTO;

SELECT CONCAT("R$", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM   PRODUTO;

/*CALCULAR A MÉDIA DE PREÇOS DOS PRODUTOS*/
SELECT AVG (PRO_PRECO)
FROM  PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇOS"
FROM  PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM   PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM   PRODUTO;

/*SELECIONAR O PRODUTO MAIS BARATO*/
SELECT MIN(PRO_PRECO)
FROM   PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/
SELECT MIN(PRO_QUANTIDADE)
FROM   PRODUTO;

/*SELECIONAR A DATA E HORA ATUAL*/
SELECT  NOW()FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONÁRIO",
	   DATE_FORMAT(FUN_DATA_NASCIMENTO, "%d/%m/%Y") AS "DATA DE NASCIMENTO",
       TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM   FUNCIONARIO;

/*FUNÇÕES MATEMÁTICAS:
ABS - VALOR ABSOLUTO DE UM NÚMERO
ROUND - ARREDONDAR
POWER - POTÊNCIA*/
SELECT ABS(-10),
	   ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
       POWER(PRO_PRECO,2) AS "PREÇO ELEVADOS AO QUADRADO"
FROM   PRODUTO;

/*UPPER, LOWER, TRIM*/
SELECT UPPER(FUN_NOME) AS "MAIÚSCULAS",
	   LOWER(FUN_NOME) AS "MINÚSCULAS",
       TRIM("                  Nicoly") AS "TIRANDO ESPAÇOS"
FROM   FUNCIONARIO;





















/*AGRUPAMENTOS*/
/*GROUP BY*/

SELECT	PRO_QUANTIDADE,
		COUNT(*) AS "REPETIÇÕES"
FROM	PRODUTO
GROUP BY PRO_QUANTIDADE;

/*UNION*/

SELECT	FUN_NOME,
		FUN_CPF
FROM	FUNCIONARIO
UNION
SELECT	FUN_NOME,
		FUN_CPF
FROM	FUNCIONARIO;

SELECT * FROM PRODUTO;

/*UNION*/
SELECT	PRO_NOME
FROM	PRODUTO
UNION
SELECT	"Arroz 5kg"
FROM 	DUAL
UNION	
SELECT	"Iogurt do Bob Esponja"
FROM 	DUAL;


/*UNION ALL*/
SELECT	PRO_NOME
FROM	PRODUTO
UNION	ALL
SELECT	"Arroz 5kg"
FROM 	DUAL
UNION	ALL
SELECT	"Iogurt do Bob Esponja"
FROM 	DUAL;

/*SELECT COM WHERE*/
SELECT	FUN_NOME				AS "NOME FUNCIONÁRIO",
		FUN_CPF					AS "CPF DO FUNCIONÁRIO",
		FUN_DATA_NASCIMENTO		AS "DATA DE NASCIMENTO",
        TIMESTAMPDIFF(YEAR, FUN_DATA_NASCIMENTO,NOW()) AS "IDADE"
FROM	FUNCIONARIO
WHERE	TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) >=25
AND		TIMESTAMPDIFF(YEAR,FUN_DATA_NASCIMENTO,NOW()) <=35;

/*RETORNAR OS FUNCIONÁRIOS, CONSUMIDORES E SUPERMERCADOS COM EMAIL IGUAL A HOTMAIL OU OUTLOOK*/
SELECT	CON_NOME 		AS 	"NOME",
		CON_CPF			AS	"CPF/CNPJ",
        CON_TELEFONE 	AS 	"TELEFONE",
        CON_EMAIL		AS 	"EMAIL",
        "CONSUMIDOR"	AS	"TIPO"
FROM	CONSUMIDOR
WHERE	UPPER(CON_EMAIL) LIKE "%EMAIL%"
OR		UPPER(CON_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT	FUN_NOME 		AS	"NOME",
		FUN_CPF			AS	"CPF/CNPJ",
        FUN_TELEFONE	AS	"TELEFONE",
        FUN_EMAIL		AS	"EMAIL",
        "FUNCIONARIO"	AS	"TIPO"
FROM	FUNCIONARIO
WHERE	UPPER(FUN_EMAIL) LIKE "%EMAIL%"
OR		UPPER(FUN_EMAIL) LIKE "%OUTLOOK%"
UNION
SELECT	SUP_RAZAO_SOCIAL	AS	"NOME",
		SUP_CNPJ			AS	"CPF/CNPJ",
        SUP_TELEFONE		AS	"TELEFONE",
        SUP_EMAIL			AS	"EMAIL",
		"SUPERMERCADO"		AS	"TIPO"
FROM	SUPERMERCADO
WHERE	UPPER(SUP_EMAIL)	LIKE "%EMAIL%"
OR		UPPER(SUP_EMAIL)	LIKE "%OUTLOOK%";

/*CROSS JOIN:
RETORNAR TODOS OS PRODUTOS E OS SUPERMERCADOS EM QUE SÃO VENDIDOS*/
SELECT	PRODUTO.PRO_NOME 				AS	"NOME",
		PRODUTO.PRO_CODIGO_BARRAS		AS	"CÓDIGO DE BARRAS",
        SUPERMERCADO.SUP_RAZAO_SOCIAL	AS	"RAZÃO SOCIAL"
FROM	SUPERMERCADO_PRODUTO
CROSS JOIN 	SUPERMERCADO
CROSS JOIN 	PRODUTO
WHERE		PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND			SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;	

/*INNER JOIN:
RETORNAR APENAS OS PRODUTOS QUE FORAM COMPRADOS POR ALGUM CONSUMIDOR*/

SELECT		PRODUTO_CONSUMIDOR.PCO_ID	AS	"ID DA COMPRA",
			PRODUTO.PRO_NOME			AS	"NOME DO PRODUTO",
            PRODUTO.PRO_CODIGO_BARRAS	AS	"CÓDIGO DE BARRAS",
            CONSUMIDOR.CON_NOME			AS	"NOME DO CONSUMIDOR",
            CONSUMIDOR.CON_CPF			AS	"CPF DO CONSUMIDOR"
FROM		PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCÍCIO COM INNER JOIN:
RETORNAR APENAS OS FUNCIONÁRIOS QUE TRABALHAM EM UM SUPERMERCADO
RETORNAR O NOME DO FUNCIONÁRIO E O NOME DOS SUPERMERCADO QUE ELE TRABALHA*/

SELECT		FUN_NOME			AS "NOME D FUNCIONÁRIO",
			SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL"
FROM		FUNCIONARIO
INNER JOIN	SUPERMERCADO ON (FK_SUP_CNPJ = SUP_CNPJ);

/*EXERCÍCIO 2 COM INNER JOIN:
RETORNAR APENAS OS PRODUTOS QUE EXISTAM EM UM SUPERMERCADO
RETORNAR O NOME DO PRODUTO E O NOME DO SUPERMERCADO QUE ELE ESTÁ DISPONÍVEL*/

SELECT 		PRODUTO.PRO_NOME				AS "NOME DO PRODUTO",
			SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "RAZÃO SOCIAL"
FROM 		SUPERMERCADO_PRODUTO
INNER JOIN	PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN	SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT 		PRODUTO.PRO_NOME				AS "NOME DO PRODUTO",
			SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "RAZÃO SOCIAL"
FROM 		SUPERMERCADO_PRODUTO
INNER JOIN	PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN	SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*LEFT JOIN*/

INSERT INTO PRODUTO (	PRO_CODIGO_BARRAS, 
						PRO_NOME,PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUE				(	"3333333333",
						"KitKat",
                        "30",
                        "1500",
                        4.50,
                        "2026-01-01");
                        
SELECT	PRODUTO.PRO_NOME,
		SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM	PRODUTO
LEFT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT * FROM SUPERMERCADO;

SELECT	PRODUTO.PRO_NOME,
		SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM	PRODUTO
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*SELECT COM LEFT JOIN E RIGHT JOIN*/
SELECT *
FROM (
			SELECT 		S.SUP_RAZAO_SOCIAL 			AS RAZAO_SOCIAL,
						F.FUN_NOME 					AS NOME_FUNCIONARIO,
						P.PRO_NOME					AS NOME_PRODUTO,
						C.CON_NOME					AS NOME_CONSUMIDOR
            FROM		SUPERMERCADO S
            LEFT JOIN	FUNCIONARIO F 				ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
            LEFT JOIN 	SUPERMERCADO_PRODUTO SP		ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
            LEFT JOIN	PRODUTO P 					ON (SP.FK_PRO_ID = P.PRO_ID)
            LEFT JOIN 	PRODUTO_CONSUMIDOR PC 		ON (P.PRO_ID = PC.FK_PRO_ID)
            LEFT JOIN 	CONSUMIDOR C 				ON (PC.FK_CON_CPF = C.CON_CPF)
            
            UNION
            
            SELECT 		S.SUP_RAZAO_SOCIAL 			AS RAZAO_SOCIAL,
						F.FUN_NOME 					AS NOME_FUNCIONARIO,
						P.PRO_NOME					AS NOME_PRODUTO,
						C.CON_NOME					AS NOME_CONSUMIDOR
            FROM		SUPERMERCADO S
            RIGHT JOIN	FUNCIONARIO F 				ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
            RIGHT JOIN 	SUPERMERCADO_PRODUTO SP		ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
            RIGHT JOIN	PRODUTO P 					ON (SP.FK_PRO_ID = P.PRO_ID)
            RIGHT JOIN 	PRODUTO_CONSUMIDOR PC 		ON (P.PRO_ID = PC.FK_PRO_ID)
            RIGHT JOIN 	CONSUMIDOR C 				ON (PC.FK_CON_CPF = C.CON_CPF)
) SELECT_EXTERNO
ORDER BY 	SELECT_EXTERNO.RAZAO_SOCIAL 			ASC,
			SELECT_EXTERNO.NOME_FUNCIONARIO 		DESC,
			SELECT_EXTERNO.NOME_PRODUTO 			ASC,
			SELECT_EXTERNO.NOME_CONSUMIDOR 			DESC;

/*EXERCÍCIOS*/
/*1*/

SELECT 		PRODUTO.PRO_NOME				AS "NOME DO PRODUTO",
			SUPERMERCADO.SUP_RAZAO_SOCIAL	AS "RAZÃO SOCIAL"
FROM 		SUPERMERCADO_PRODUTO
INNER JOIN	PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN	SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*2*/

SELECT		FUN_NOME			AS "NOME DO FUNCIONÁRIO",
			SUP_RAZAO_SOCIAL 	AS "RAZÃO SOCIAL"
FROM		FUNCIONARIO
INNER JOIN	SUPERMERCADO ON (FK_SUP_CNPJ = SUP_CNPJ);

/*3*/

SELECT		CONSUMIDOR.CON_NOME			AS	"NOME DO CONSUMIDOR",
			PRODUTO.PRO_NOME			AS	"NOME DO PRODUTO"
FROM		PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*4*/
SELECT 		PRODUTO.PRO_NOME			AS "NOME DO PRODUTO",
			CONSUMIDOR.CON_NOME 		AS "NOME DO CONSUMIDOR"
FROM 		PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*5*/

SELECT  SUP_RAZAO_SOCIAL AS "NOME MERCADO",
		COUNT(*) AS "QUANTIDADE"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
GROUP BY   SUPERMERCADO.SUP_RAZAO_SOCIAL;


/*exercício 2 
SUPERMERCADO E PRODUTO*/

SELECT	S.SUP_RAZAO_SOCIAL,
		P.PRO_NOME

FROM	SUPERMERCADO S
LEFT JOIN SUPERMERCADO_PRODUTO SP  ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
LEFT JOIN PRODUTO P ON (P.PRO_ID = SP.FK_PRO_ID);

/* FUNCIONARIO E SUPERMERCADO*/

SELECT 	F.FUN_NOME,
		S.SUP_RAZAO_SOCIAL
        
FROM 	FUNCIONARIO F
LEFT JOIN SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

SELECT * FROM FUNCIONARIO;

/* CONSUMIDOR E PRODUTO*/

SELECT 	C.CON_NOME,
		P.PRO_NOME

FROM	CONSUMIDOR C
LEFT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
LEFT JOIN PRODUTO P ON (P.PRO_ID = PC.FK_PRO_ID);

/* PRODUTOS E CONSUMIDORES*/

SELECT 	P.PRO_NOME,
		C.CON_NOME

FROM	PRODUTO P
LEFT JOIN PRODUTO_CONSUMIDOR PC ON (P.PRO_ID = PC.FK_PRO_ID)
LEFT JOIN CONSUMIDOR C ON (C.CON_CPF = PC.FK_CON_CPF);

/*SUPERMERCADOS E FUNCIONÁRIOS*/

SELECT 	S.SUP_CNPJ,
		F.FUN_NOME
        
FROM 	SUPERMERCADO S
LEFT JOIN FUNCIONARIO F ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);


/*RIGHT JOIN
EXERCÍCIO 03
PRODUTOS E SUPERMERCADOS*/

SELECT 	P.PRO_NOME,
		S.SUP_RAZAO_SOCIAL
        
FROM 	SUPERMERCADO S
RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO P ON (P.PRO_ID = SP.FK_PRO_ID);


/*EXERCÍCIO 03
CONSUMIDORES E PRODUTOS*/

SELECT 	C.CON_NOME,
		P.PRO_NOME
        
FROM CONSUMIDOR C
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
RIGHT JOIN PRODUTO P ON (P.PRO_ID = PC.FK_PRO_ID);

/*EXERCÍCIO 03
FUNCIONARIOS E SUPERMERCADOS*/

SELECT 	F.FUN_NOME,
		S.SUP_RAZAO_SOCIAL
FROM FUNCIONARIO F
RIGHT JOIN SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);


/*EXERCÍCIO 03
PRODUTOS E SUPERMERCADOS*/

SELECT 	P.PRO_NOME,
		S.SUP_RAZAO_SOCIAL
        
FROM 	SUPERMERCADO S
RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
RIGHT JOIN PRODUTO P ON (P.PRO_ID = SP.FK_PRO_ID);

/*EXERCÍCIO 03
CONSUMIDOR E PRODUTO*/

SELECT 	C.CON_NOME,
		P.PRO_NOME
        
FROM CONSUMIDOR C
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (C.CON_CPF = PC.FK_CON_CPF)
RIGHT JOIN PRODUTO P ON (P.PRO_ID = PC.FK_PRO_ID);

/*Selecionar apenas os PRODUTOS que possuem registro em um SUPERMERCADO e que foram comprados por um CONSUMIDOR
SUBCONSULTAS (IN)*/

SELECT 	P.PRO_NOME 			AS "NOME DO PRODUTO",
		P.PRO_CODIGO_BARRAS	AS "CÓDIGO DE BARRAS",
        P.PRO_PRECO			AS "PREÇO DO PRODUTO"
FROM 	PRODUTO P 
WHERE	P.PRO_ID IN (SELECT SP.FK_PRO_ID FROM SUPERMERCADO_PRODUTO SP)
AND 	P.PRO_ID IN (SELECT PC.FK_PRO_ID FROM PRODUTO_CONSUMIDOR PC);

/*Selecionar apenas os PRODUTOS que NÃO possuem registro em um SUPERMERCADO e que NÃO foram comprados por um CONSUMIDOR
SUBCONSULTAS (IN)*/

SELECT 	P.PRO_NOME 			AS "NOME DO PRODUTO",
		P.PRO_CODIGO_BARRAS	AS "CÓDIGO DE BARRAS",
        P.PRO_PRECO			AS "PREÇO DO PRODUTO"
FROM 	PRODUTO P 
WHERE	P.PRO_ID NOT IN (SELECT SP.FK_PRO_ID FROM SUPERMERCADO_PRODUTO SP)
AND 	P.PRO_ID NOT IN (SELECT PC.FK_PRO_ID FROM PRODUTO_CONSUMIDOR PC);

/*Selecionar os SUPERMERCADOS que tem o preço de todos os produtos menor que 10.
SUBCONSULTAS (ALL)*/

SELECT 	S.SUP_RAZAO_SOCIAL
FROM	SUPERMERCADO S 
WHERE	10 > ALL (
		SELECT 	P.PRO_PRECO
        FROM	PRODUTO P 
);

/*Listar todos os PRODUTOS cujo preço seja maior que o preço de qualquer produto vendido no SUPERMERCADO com CNPJ 123456780000102*/

SELECT 	PRO_NOME,
		PRO_PRECO
FROM	PRODUTO
WHERE	PRO_PRECO > ANY (
		SELECT		PRO_PRECO
        FROM		PRODUTO P
        INNER JOIN 	SUPERMERCADO_PRODUTO SP
        ON			(P.PRO_ID = SP.FK_PRO_ID)
        WHERE		SP.FK_SUP_CNPJ = '123456780000102'
);

/*Listar todos os CONSUMIDORES que compraram pelo menos UM PRODUTO*/
SELECT	C.CON_NOME,
		C.CON_CPF
FROM	CONSUMIDOR C 
WHERE 	EXISTS (
		SELECT 1
        FROM 	PRODUTO_CONSUMIDOR PC
        WHERE 	PC.FK_CON_CPF = C.CON_CPF
);